# Main Hydra configuration for LDC solvers
#
# STANDARD USAGE - Always use -m (multirun mode):
#
#   Validation:
#     uv run python run_solver.py -m +experiment=validation/ghia
#
#   Benchmarking:
#     uv run python run_solver.py -m +experiment=benchmarking/multigrid_comparison
#
#   Quick testing:
#     uv run python run_solver.py -m +experiment=testing/quick_test
#
#   Custom sweeps:
#     uv run python run_solver.py -m solver=fv N=16,32,64 Re=100,400
#
#   Override machine for HPC:
#     uv run python run_solver.py -m machine=hpc +experiment=validation/ghia
#
# Regenerate plots (separate tool):
#   uv run python plot_runs.py +experiment=validation/ghia
#
# Single runs (testing only, no -m flag needed):
#   uv run python run_solver.py solver=fv N=32 Re=100

defaults:
  - problem: ldc
  - solver: fv
  - mlflow: local
  - machine: local
  - _self_

# Grid size (must be set by experiment or command line)
N: 32

# Solver control (taken from solver config)
tolerance: ${solver.tolerance}
max_iterations: ${solver.max_iterations}

# Default experiment name (typically overridden by experiment config)
experiment_name: LDC-Dev
sweep_name: dev-run

# =============================================================================
# Hydra output paths and callbacks
# =============================================================================
hydra:
  # Always use multirun mode by default
  mode: MULTIRUN
  run:
    dir: hydra_outputs/runs/${now:%d-%m-%y}/${now:%H:%M:%S}
  sweep:
    dir: hydra_outputs/multirun/${now:%d-%m-%y}/${now:%H:%M:%S}
    subdir: ${hydra.job.num}
  callbacks:
    mlflow_sweep:
      _target_: utilities.mlflow.callback.MLflowSweepCallback
