# Main Hydra configuration for LDC solvers
#
# Usage:
#   uv run python main.py -m +experiment/validation/ghia=fv      # solve + plot
#   uv run python main.py -m +experiment/validation/ghia=fv plot_only=true  # plot only
#   uv run python main.py solver=fv N=32 Re=100                  # single run

defaults:
  - problem: ldc
  - solver: fv
  - mlflow: local
  - machine: local
  - _self_

# Grid size (must be set by experiment or command line)
N: 32

# Solver control (taken from solver config)
tolerance: ${solver.tolerance}
max_iterations: ${solver.max_iterations}

# Default experiment name (typically overridden by experiment config)
experiment_name: LDC-Dev
sweep_name: dev-run

# Plot-only mode (skip solving, regenerate plots from existing runs)
plot_only: false

# =============================================================================
# Hydra output paths and callbacks
# =============================================================================
hydra:
  # Always use multirun mode by default
  mode: MULTIRUN
  run:
    dir: hydra_outputs/runs/${now:%d-%m-%y}/${now:%H:%M:%S}
  sweep:
    dir: hydra_outputs/multirun/${now:%d-%m-%y}/${now:%H:%M:%S}
    subdir: ${hydra.job.num}
  callbacks:
    mlflow_sweep:
      _target_: utilities.mlflow.callback.MLflowSweepCallback
